INFO:src.models.train:Starting training with config: {'epochs': 100, 'batch_size': 64, 'learning_rate': 0.0001, 'patience': 15, 'min_delta': 0.0001, 'max_grad_norm': 1.0, 'validation_split': 0.2, 'use_cache': True, 'wandb_project': 'club-recommender', 'model_name': 'club_recommender', 'hidden_size': 1024, 'num_hidden_layers': 4, 'intermediate_size': 2048, 'num_attention_heads': 16, 'temperature': 0.1, 'label_smoothing': 0.1, 'contrastive_weight': 0.2, 'categorical_dropout': 0.2, 'text_dropout': 0.2, 'feature_dropout': 0.2, 'attention_dropout': 0.1, 'use_layer_norm': True, 'scheduler_div_factor': 10.0, 'scheduler_final_div_factor': 100.0, 'scheduler_pct_start': 0.1, 'use_amp': True, 'grad_clip_enabled': True, 'gradient_checkpointing': True, 'use_club_metadata': True, 'attention_heads': 16}
INFO:src.models.train:Loading dataset...
Computing club embeddings...
Traceback (most recent call last):
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 161, in <module>
    main()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 152, in main
    run_train(config)
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 98, in run_train
    train_model(
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/train.py", line 397, in train_model
    dataset = RecommenderDataset(
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/train.py", line 265, in __init__
    self.club_embeddings = ClubEmbeddings(clubs_csv)
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 102, in __init__
    self.load_or_compute_embeddings()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 114, in load_or_compute_embeddings
    self._compute_and_cache_embeddings()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 122, in _compute_and_cache_embeddings
    text_model = SentenceTransformer('NovaSearch/stella_en_1.5B_v5', trust_remote_code=True)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py", line 347, in __init__
    self.to(device)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1340, in to
    return self._apply(convert)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  [Previous line repeated 3 more times]
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 988, in _apply
    self._buffers[key] = fn(buf)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1326, in convert
    return t.to(
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 161, in <module>
    main()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 152, in main
    run_train(config)
  File "/Users/benjamingaskin/Documents/nScribe/anchor/main.py", line 98, in run_train
    train_model(
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/train.py", line 397, in train_model
    dataset = RecommenderDataset(
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/train.py", line 265, in __init__
    self.club_embeddings = ClubEmbeddings(clubs_csv)
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 102, in __init__
    self.load_or_compute_embeddings()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 114, in load_or_compute_embeddings
    self._compute_and_cache_embeddings()
  File "/Users/benjamingaskin/Documents/nScribe/anchor/src/models/embeddings.py", line 122, in _compute_and_cache_embeddings
    text_model = SentenceTransformer('NovaSearch/stella_en_1.5B_v5', trust_remote_code=True)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/sentence_transformers/SentenceTransformer.py", line 347, in __init__
    self.to(device)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1340, in to
    return self._apply(convert)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 900, in _apply
    module._apply(fn)
  [Previous line repeated 3 more times]
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 988, in _apply
    self._buffers[key] = fn(buf)
  File "/Users/benjamingaskin/Library/Caches/pypoetry/virtualenvs/anchor-D7vU4ROR-py3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1326, in convert
    return t.to(
KeyboardInterrupt
